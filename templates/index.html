<!DOCTYPE html>
<html>
    <head>
        <title>Asha Ivey - Portfolio Website</title>

        <!-- JQuery for one specific issue of getting plain text (rather than html) from database -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1"/>

        <link rel='stylesheet' href='../static/css/style.css'>
        <link rel='stylesheet' media='screen and (min-width:768px)' href='../static/css/home.css'>
        <link rel='stylesheet' media='screen and (max-width:767px)' href='../static/css/home_small.css'>

        <script src='../static/js/home.js'></script>
        <link rel='shortcut icon' sizes='256x256' href='../static/images/ashaiv-favicon-32x32.png'>

        <script type="importmap">
            {
              "imports": {
                "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
                "three/addons/OrbitControls": "https://unpkg.com/three@0.160.0/examples/jsm/controls/OrbitControls.js"
              }
            }
        </script>
          
        <!-- Font Stuff -->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Alegreya+Sans:wght@300;400;500&family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">    
    </head>
      
    <body class='beginning' onload="loadData()">
        <script type="module">
            import * as THREE from 'three';
            import { OrbitControls } from 'three/addons/OrbitControls';

            const renderer = new THREE.WebGLRenderer({antialias: true});
            renderer.shadowMap.enabled = true;
            renderer.shadowMap.type = THREE.BasicShadowMap;
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setClearColor(0xEFEFEE);
            
            document.getElementById("threejs-container").appendChild(renderer.domElement);

            const scene = new THREE.Scene();
            scene.fog = new THREE.Fog(0x2E0F1F, 100, 500);

            const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.z = 50;
            scene.add(camera);

            // const controls = new OrbitControls( camera, renderer.domElement );
            // controls.update();

            // SHAPE GEOMETRY //
            const loader = new THREE.TextureLoader();
            const occlusionMap = loader.load('/static/images/MetalTexture/AOMap.png');
            const specularMap = loader.load('/static/images/MetalTexture/SpecularMap.png');

            occlusionMap.colorSpace = THREE.SRGBColorSpace;
            specularMap.colorSpace = THREE.SRGBColorSpace;

            const shapeMaterialObject = {
                color: 0xE5FCFF,
                emissive: 0x2E0F1F,
                roughness: .4,
                ior: 1.5,
                reflectivity: 1,
                iridescence: 1,
                aoMap: occlusionMap,
                aoMapIntensity: 0.2,
                lightMap: specularMap,
                lightMapIntensity: 0.2,
            }
            const shapeMaterial = new THREE.MeshPhysicalMaterial(shapeMaterialObject);

            const boxGeometry = new THREE.BoxGeometry(20, 20, 20);
            const cube = new THREE.Mesh(boxGeometry, shapeMaterial);
            cube.receiveShadow = true;
            cube.castShadow = true;
            scene.add(cube);

            const octoGeometry = new THREE.OctahedronGeometry(10, 0);
            const octo = new THREE.Mesh(octoGeometry, shapeMaterial);
            octo.receiveShadow = true;
            octo.castShadow = true;
            scene.add(octo);

            const torusGeometry = new THREE.TorusGeometry(10, 2, 14, 80); 
            const torus = new THREE.Mesh(torusGeometry, shapeMaterial); 
            torus.receiveShadow = true;
            torus.castShadow = true;
            scene.add(torus);

            const cylinderGeometry = new THREE.CylinderGeometry(10, 10, 28, 30); 
            const cylinder = new THREE.Mesh(cylinderGeometry, shapeMaterial); 
            cylinder.receiveShadow = true;
            cylinder.castShadow = true;
            scene.add(cylinder);

            // LIGHTS //
            const mainLight = new THREE.DirectionalLight(0xAFBFE8, 1.5);
            mainLight.position.set(-100, 50, 0);
            scene.add(mainLight);  

            const pinkLight = new THREE.DirectionalLight(0xC16197, 1.5);
            pinkLight.position.set(-100, -50, 0);
            scene.add(pinkLight); 

            const yellowLight = new THREE.DirectionalLight(0xF0E85B, 1.5);
            yellowLight.position.set(100, -50, 0);
            scene.add(yellowLight); 

            const greenLight = new THREE.DirectionalLight(0x15E066, 0.5);
            greenLight.position.set(100, 50, 0);
            scene.add(greenLight);  

            const hemisphereLight = new THREE.HemisphereLight(0xE5FCFF, 0xB48FC6, 2.5);
            scene.add(hemisphereLight);

            /////////////////////////////
            // Animate Object Movement //
            /////////////////////////////
            var cubePosition = {
                x: 0,
                y: -20,
                newX: 0,
                newY: 0,
            }

            cube.position.z = 0;

            var torusPosition = {
                x: 40,
                y: -30,
                newX: 0,
                newY: 0,
                spin: true,
            }

            torus.position.z = -10;

            var octoPosition = {
                x: -55,
                y: 30,
                newX: 0,
                newY: 0,
            }

            octo.position.z = -20;

            var cylinderPosition = {
                x: -50,
                y: 5,
                newX: 0,
                newY: 0,
            }

            cylinder.position.z = -40;

            var mousePosition = {
                x: 0,
                y: 0,
            }

            function animate() {
                requestAnimationFrame(animate);

                // Spin rate
                var spinRate;
                const TAU = Math.PI * 2;

                // Cube distance from mouse to determine movement speed
                const cubeDistance = dist(cubePosition.newX, cubePosition.newY, cube.position.x, cube.position.y);
                var cubeRate;
                if (Math.abs(cubeDistance) > 20) {
                    cubeRate = 0.08;
                    spinRate = 0.2;
                } else {
                    cubeRate = 0.05;
                    spinRate = 0.1;
                }

                cube.position.x += (cubePosition.newX - cube.position.x) * cubeRate;
                cube.position.y += (cubePosition.newY - cube.position.y) * cubeRate;
                cube.rotation.x = (cube.rotation.x + cubeRate * spinRate) % TAU;
                cube.rotation.y = (cube.rotation.y + cubeRate * spinRate) % TAU;
                cube.rotation.z = (cube.rotation.z + cubeRate * spinRate) % TAU;

                // octahedron distance from mouse to determine movement speed
                const octoDistance = dist(octoPosition.newX, octoPosition.newY, octo.position.x, octo.position.y);
                var octoRate;
                if (Math.abs(octoDistance) > 20) {
                    octoRate = 0.08;
                    spinRate = 0.3;
                } else {
                    octoRate = 0.05;
                    spinRate = 0.1;
                }
                
                octo.position.x += (octoPosition.newX - octo.position.x) * octoRate;
                octo.position.y += (octoPosition.newY - octo.position.y) * octoRate;
                octo.rotation.x = (octo.rotation.x + octoRate * spinRate) % TAU;
                octo.rotation.y = (octo.rotation.y + octoRate * spinRate) % TAU;
                octo.rotation.z = (octo.rotation.z + octoRate * spinRate) % TAU;

                // Torus distance from mouse to determine movement speed
                const torusDistance = dist(torusPosition.newX, torusPosition.newY, torus.position.x, torus.position.y);
                var torusRate;
                if (Math.abs(torusDistance) > 20) {
                    torusRate = 0.08;
                    spinRate = 0.3;
                } else {
                    torusRate = 0.05;
                    spinRate = 0.05;
                }
                
                torus.position.x += (torusPosition.newX - torus.position.x) * torusRate;
                torus.position.y += (torusPosition.newY - torus.position.y) * torusRate;

                // Torus is used to emphasize CTA button. At that point, it needs to stop spinning
                if (torus.position.spin == false) {
                    torus.rotation.x += ((0 - torus.rotation.x) * torusRate);
                    torus.rotation.y += ((0 - torus.rotation.y) * torusRate);
                    torus.rotation.z += ((0 - torus.rotation.z) * torusRate);
                } else {
                    torus.rotation.x = (torus.rotation.x - 0 + torusRate * spinRate) % TAU;
                    torus.rotation.y = (torus.rotation.y - 0 + torusRate * spinRate) % TAU;
                    torus.rotation.z = (torus.rotation.z - 0 + torusRate * spinRate) % TAU;
                }

                // Cylinder distance from mouse to determine movement speed
                const cylinderDistance = dist(cylinderPosition.newX, cylinderPosition.newY, cylinder.position.x, cylinder.position.y);
                var cylinderRate;
                if (Math.abs(cylinderDistance) > 20) {
                    cylinderRate = 0.08;
                    spinRate = 0.1;
                } else {
                    cylinderRate = 0.05;
                    spinRate = 0.05;
                }
                
                cylinder.position.x += (cylinderPosition.newX - cylinder.position.x) * cylinderRate;
                cylinder.position.y += (cylinderPosition.newY - cylinder.position.y) * cylinderRate;
                cylinder.rotation.x = (cylinder.rotation.x + cylinderRate * spinRate) % TAU;
                cylinder.rotation.y = (cylinder.rotation.y + cylinderRate * spinRate) % TAU;
                cylinder.rotation.z = (cylinder.rotation.z + cylinderRate * spinRate) % TAU;

                renderer.render(scene, camera);
            }

            function unspreadObjects() {
                cubePosition.newX = 0;
                cubePosition.newY = 0;

                octoPosition.newX = 0;
                octoPosition.newY = 0;

                torusPosition.newX = 0;
                torusPosition.newY = 0;

                cylinderPosition.newX = 0;
                cylinderPosition.newY = 0;
            }

            function ctaObjects() {
                cubePosition.newX = 0;
                cubePosition.newY = 0;

                octoPosition.newX = 0;
                octoPosition.newY = 0;

                torusPosition.newX = 35;
                torusPosition.newY = -30;

                cylinderPosition.newX = 0;
                cylinderPosition.newY = 0;
            }

            function updateObjectLocations(clientX, clientY, mouseX, mouseY) {  
                // Ratios determine how close to the mouse location should the object go
                const cubeRatio = .2;
                const torusRatio = .1;
                const octoRatio = .15;
                const cylinderRatio = .3;

                // Set cube 'new' positions so that the object can be animated towards that location
                cubePosition.newX = cubePosition.x + (cubeRatio * mouseX);
                cubePosition.newY = cubePosition.y + (cubeRatio * mouseY);

                // Set octo 'new' positions so that the object can be animated towards that location
                octoPosition.newX = octoPosition.x + (octoRatio * mouseX);
                octoPosition.newY = octoPosition.y + (octoRatio * mouseY);

                // Set torus 'new' positions 
                torusPosition.newX = torusPosition.x + (torusRatio * mouseX);
                torusPosition.newY = torusPosition.y + (torusRatio * mouseY);

                // Set cylinder 'new' positions 
                cylinderPosition.newX = cylinderPosition.x + (cylinderRatio * mouseX);
                cylinderPosition.newY = cylinderPosition.y + (cylinderRatio * mouseY);
            }

            /**
             * Spread Flag determines which configuration to put the objects in
             *     - 0: Spread out
             *     - 1: Unspread (All in center behind rotating cube)
             *     - 2: CTA Spread (All in center except torus, which rotates near the cta button)
             **/
            var spreadFlag = 1;
            window.addEventListener("mouseover", (event) => {
                if (event.target.classList.contains("unspread")) {
                    spreadFlag = 1;
                } else if (event.target.classList.contains("ctaSpread")) {
                    spreadFlag = 2;
                    torus.position.spin = false;
                }
            });

            window.addEventListener("mouseout", (event) => {
                if (event.target.classList.contains("unspread") || event.target.classList.contains("ctaSpread")) {
                    spreadFlag = 0;
                    torus.position.spin = true;
                }
            });

            window.addEventListener("mousemove", (event) => {
                if (spreadFlag == 0) {
                    // Get mouse distance from center of window
                    const mouseX = event.clientX - (window.innerWidth / 2);
                    const mouseY = -1 * (event.clientY - (window.innerHeight / 2));

                    // Create a vector in 3d space for mouse coordinates
                    var mouseVector = new THREE.Vector3();
                    var mousePos = new THREE.Vector3();

                    mouseVector.set(mouseX, mouseY, 0);
                    mouseVector.unproject(camera);
        
                    var distance = camera.position.z / mouseVector.z;
        
                    mousePos.copy(camera.position).add(mouseVector.multiplyScalar(distance));

                    // Save new mouse coordinates
                    mousePosition.x = mousePos.getComponent(0);
                    mousePosition.y = mousePos.getComponent(1);

                    updateObjectLocations(event.clientX, event.clientY, mousePosition.x, mousePosition.y);
                } else if (spreadFlag == 1) {
                    unspreadObjects();
                } else if (spreadFlag == 2) {
                    ctaObjects();
                }
            });

            window.addEventListener("resize", () => {
                const width = window.innerWidth;
                const height = window.innerHeight;
                
                camera.aspect = width / height;
                camera.updateProjectionMatrix();
                renderer.setSize(width, height);
                renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
            });

            animate();
        </script>

        <div id='top' display='none'></div>

        <div class="mobile-nav mobile-nav-bar">
            <button class='mobile-nav' onclick='logoAction()'>
                <img id='mobile-logo' src="../static/images/ashaiv-favicon-32x32.png">
            </button>
            <button class='nav_toggle mobile-nav' onclick='toggleMenu()'>
                <img id='toggle-logo' class="hamburg" src="../static/images/hamburger-icon.svg">
            </button>
        </div>
        
        <nav> 
            <button class='nav_button unspread' onclick='homeAction()'>Home</button>
            <button class='nav_button unspread' onclick='aboutAction()'>About</button>
            <button class='nav_button unspread' onclick='projectAction()'>Projects</button>
            <button class='nav_button unspread' onclick='resumeAction()'>Resume</button>
            <button class='nav_button unspread' onclick='contactAction()'>Contact</button>
        </nav> 

        <div id="threejs-container"></div>

        <div id='home' class='container'>
            <h1 id='home_title'>Asha Ivey</h1>
            <h4 id="greeting"></h4>
            <button class="cta-button ctaSpread" onclick="ctaAction()">See Projects</button>
            <div id="down-icon-container">
                <img id='down-icon' onclick='aboutAction()' src="../static/images/down-icon-ashaiv.svg">
            </div>
        </div>
        
        <div id='about' class="container">
            <div class="container-content">
                <div id="about-content">
                    <h2>About</h2>
                    <div id="about-image">
                        <p class='center-align'>
                        <img id='headshot' src='../static/images/AshaPortrait.png'>
                        </p>
                    </div>
                    <div id='about-text'>
                        <!-- Ideally, I want there to be a short version and a long version -->
                        <!-- so that people can chose whether or not they want to read the -->
                        <!-- whole page or just scroll through. -->
                        <p id='about-description'></p>
                    </div> 
                    
                </div>
                <h4 id="skills-header">Things I Know How to Use:</h4>
                <hr>
                <div id="about-skills"></div>
            </div>
        </div>

        <div id='projects' class="container">
            <div class="container-content">
                <h2>Projects</h2>
                <div id='projects-container'></div>
            </div>
        </div>

        <div id='resume' class="container">
            <div class="container-content">
                <h2>Resume</h2>
                <div id='resume-container'>
                    <iframe id='most-recent-resume' src='../static/documents/Post-Grad_Resume_Summer2022.pdf#view=Fit' loading="lazy" title="Asha's Resume"></iframe>
                </div>
            </div>
        </div>

        <div id='contact' class="container">
            <div class="container-content">
                <h2>Contact Me</h2>

                <form action="https://api.web3forms.com/submit" method="POST">
                    <input type="hidden" name="access_key" value="5c5de659-ad1d-4cde-802b-b4372560e55b">
                    <input type="hidden" name="subject" value="New Submission from Web3Forms">
                
                    <div id="name-div">
                        <label class="required-input" for="name">Name</label>
                        <input type="text" name="name" required>
                    </div>

                    <div id="email-div">
                        <label class="required-input" for="email">Email</label>
                        <input type="email" name="email" required>
                    </div>

                    <div id="message-div">
                        <label class="required-input" for="message">Message</label>
                        <textarea name="message" rows="4" cols="50" required></textarea>
                    </div>
                    
                    <button class="cta-button" type="submit">Submit</button>
                
                </form>
                
                <script src="https://web3forms.com/client/script.js" async defer></script>
                
                <div id='contact-methods'> 
                    <div class='contact-icon'>
                        <a target="_blank" rel="noopener noreferrer" href='https://github.com/aivey65'>
                            <img src="../static/images/github-mark-white.svg">
                        </a>
                    </div> 
                    <div class='contact-icon'>
                        <a target="_blank" rel="noopener noreferrer" href='https://www.linkedin.com/in/ashaiv/'>
                            <img src="../static/images/LI-In-Bug.png">
                        </a>
                    <div>
                </div> 
            </div>
        </div>

        {% if scroll %}
        <script>
            $(document).ready(() => {
                // Handler for .ready() called.
                setTimeout(() => {
                    $('html, body').animate({
                        scrollTop: $('#{{scroll}}').offset().top
                    }, 'slow');
                }, 700);
            }); 
            window.history.replaceState({}, "", "/");
        </script>
        {% endif %}
    </body>
</html>